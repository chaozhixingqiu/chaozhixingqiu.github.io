# 给科学家的R

前言：虽然我非常喜欢Python，但我必须要认真的推荐一波R......

咱们这是统计学系列的学习，不可避免的要有一些编程语言相关的东西。而这必然而然的会牵扯到学什么语言的问题。

事实上，对于想从事数据科学的新手，R和Python可能是最好的/唯一的两个选择。这两者是目前数据科学领域最流行的两款高级编程语言，两者都是开源的，也都有非常活跃的社区来支撑。

那么问题来了：对于初学者，到底应该学哪个？

当然了，我的建议：**看情况（it depends），选用何种编程语言，依赖于你的背景以及你的长期目标。** 换句话说：你是干啥的？以及你的目标是什么？

## 先简要介绍下R

R是在用户数量和分析功能方面增长最快的分析工具。它也被称为“R Project”，具有多种描述，例如：

* 用于统计分析、数据可视化和预测建模的数据分析软件
* 一种面向对象的编程语言，提供了对象、运算符和函数来探索、建模和可视化数据
* 用于统计分析的环境，支持几乎所有数据分析所需的数据处理、统计模型和图表
* 一个开源软件项目，得到了庞大用户社区的广泛采取，在质量和数字准确度方面树立了高标准

目前存在各种挖掘软件，主流的商用挖掘工具比如Unica、SAS/EM、InsightfulMiner、IBMIM、Matlab和SPSS等，这些软件特点是面向通用挖掘问题，功能较为完善，具备较好的性能。但一般都存在可扩展性不强、成本较高等缺点。

而R作为开源语言，能够弥补以上不足。

* 就其本身来说，R是一种跨平台的开源编程语言。开源语言是一种我们无需支付许可或费用即可使用的语言。我们可以通过优化软件包, 开发新软件包以及解决问题来为R的发展做出贡献。跨平台意味着其代码可以在所有操作系统上运行。 R使程序员仅编写一次程序就可以为多个竞争平台开发软件。 R可以在Windows, Linux和Mac上轻松运行。
* 在功能上，作为第二个向量式编程语言（Matlab是第一个），R是一套完整的数据处理、计算和制图软件系统。其功能包括：数据存储和处理系统；数组运算工具（其向量、矩阵运算方面功能尤其强大）；完整连贯的统计分析工具；优秀的统计制图功能；简便而强大的编程语言：可操纵数据的输入和输出，可实现分支、循环，用户可自定义功能。

R语言由新西兰奥克兰大学的Ross Ihaka和Robert Gentleman于1995设计出来(由于两人的名字均以 ‘R’ 字母开头，因此命名为R语言)，现在由“R核心开发团队“负责开发。

虽然R主要用于数据分析、绘图以及数据挖掘，但也有人用作矩阵计算。其计算速度可媲美专用于矩阵计算的开源软件GNU Octave和商业软件MATLAB。

起初R主要在学术研究中使用，但近年来在企业界也表现突出，这使得R成为企业中使用的全球发展最快的统计语言之一。

说完了R，那接下来，我们一起看看什么情况下选R更好。

## 如果你的编程水平是菜鸟级，选R

对于软件开发新手来说，Python可能不错。但是数据科学和软件开发不是同一回事。

很多人第一门编程语言就是令人咋舌的C语言，因为它注重细节，可以训练人的编程思维。可是，对于很多研究人员，他们的侧重点就在理论、思想上，让他们用C语言编写自己好不容易证明出来的算法，简直比登天还难。

那么有没有哪一门编程语言把数据科学家从繁重的编程里解脱出来，把焦点移向理论研究呢？

这时候，Matlab语言出现了，Matlab以其强大的向量化和矩阵计算，解决了这个问题。如果说Matlab语言的出现可以解决这个问题，那么这个语言的出现就把解决这个问题高度推向了顶峰，那就是R语言。

解释一下为什么我认为R更适合数据科学。这种差异可归结为：

**数据科学家使用编程语言的方式与软件开发者不一样。对于数据科学新手来说，程序(programs)应该是脚本(scripts)，而不应该是函数(function)。**

学过R语言的人都知道，它简单易学，解释型的语句，一看就会，通俗易懂。包里内置模型所需的数据集，可能有时候一行命令就能完成从数据到模型构建，再到结果可视化输出的过程，极大地方便了数据科学家地研究。而且学会后还可以根据现有的包的函数编写出更适合自己的函数模块，体现出R语言的强大的可扩展性。

举个例子，我们用R语言处理一个叫Auto数据框(dataframe)：

```
library(ISLR)
data('Auto')
```

如果对R不熟悉，代码的具体意义可暂时不理会。数据框是R语言中最常用的数据类型之一，以行列的形式排布，有点类似Excel表格。

在这个“dataframe”中有个weight变量，表示汽车的重量。目前单位是千克，我们想把它的单位换成克，并作为一个新变量weight_g。

有很多方法可以实现这个任务。如果你用python，最容易想到的方法是：利用for循环遍历weight变量中的值，然后计算出新变量的值。听起来有点麻烦。

在R中，可以利用tidyverse包中已有的mutate函数直接计算出新变量的值，这个方法避免使用for循环，更简单(代码看不懂可先不理会)：

```
mutate(Auto, weight_g＝weight*1000)
```

**在R中，你应该尽量使用已有函数和包来完成相关任务，没必要自己创建工具来处理任务。** 这意味着你不需要知道很多传统意义上的编程概念。事实上你应该避免使用这些概念，比如：for循环、类、面向对象编程以及其它软件开发概念。

R语言生态里有丰富的用于数据科学和机器学习操作的软件包。R在CRAN存储库中有10,000多个软件包, 并且这些软件包正在不断增长。

其实Python也有很多工具来直接处理数据，比如pandas包，但是Python的包和语法具有‘软件开发’的味道，依赖于一些软件开发概念（像for循环、类和面向对象等等）。对于那些没有软件开发或计算机科学背景的新人来说，这些概念很难被理解。

总之，对于一个对编程不感兴趣的人，相比于Python，由于R的数据处理工具开发得更好且更容易使用，我认为R更适合上手做数据处理。

## 对于数据科学任务，R的语法更直观形象

对于数据处理任务，很多时候R的语法会更简单。函数和参数的命名设计也更好，很容易记住和使用。

举个例子，我们将分别用R和Python来删掉Iris数据框中的两个变量（由于R和Python都有Iris数据框，因此我们使用这个数据框）。

我们来看看各自的语法：

Python：

```
import seaborn as sns
import pandas as pd

iris = sns.load_dataset('iris')
iris.drop(['sepal_length', 'species'], axis = 1)
```

R：

```
library(dplyr)
select(iris, -sepal_length, -species)
```

为了删除变量，Python中使用了drop函数，而R中使用了select函数。我们来对比这两个函数(都在最后一行代码)的语法。

先讲Python的处理方法：drop函数命名得很好，容易记住。但是参数设计得很复杂。第一个参数是包含想要删除变量的列表，你必须要用方括号表示列表，而且变量一定要用引号，要不然代码会运行错误。对于初学者，经常会忘记使用方括号和引号，导致代码运行错误，也不知道为啥会出错，很是困惑。再说drop()的第二个参数axis。初学者肯定会困惑，“天啊，啥是axis，它有什么用”，一脸懵逼。事实上，在学Python的时候，你会碰到很多类似的情况，让初学者很困惑。

我们看看R是怎么处理的：为了删除变量，你可以使用R的dplyr包中的select函数。函数名字取得一般，不如Python中drop。但是参数设计得很好，第一个参数是你想处理数据框；其它参数是你想要删除的变量，前面的负号-表示删除，变量之间用逗号,隔开，都非常形象。此外这里根本没有涉及drop中所谓的 ‘axis’概念。

总之，相比Python，在数据处理方面，R的语法更直观形象，写代码如同写伪代码一样，容易记住、编写和读懂。

## 在数据处理方面，R非常优秀

R允许我们执行数据整理。R提供了诸如dplyr, readr之类的软件包, 它们能够将凌乱的数据转换为结构化形式。如果你的工作更多的是数据分析，我强烈推荐你使用R，尤其推荐你使用R中的tidyverse包。

tidyverse包是一组数据处理与可视化R包的集合体，其中的ggplot2, dplyr和stringr包都广为人知。它提供【数据导入】→【数据整理】→【数据分析】→【数据可视化】一条龙服务。假如这些就是你的日常工作，那么恭喜你了，赶快使用这个包。

tidyverse的语法也非常易学、易记和易用。特别地，包中的各种函数都命名得非常贴切，不用特意去记住它们。比如：你想“过滤”你的数据集来创建一个子集，可以使用filter()函数；如果你想选择数据集的某一列，你可以使用select()函数。

此外，tidyverse包中的函数都被高度模块化了。每个函数只干一件事情，而且做得非常好。模块化让函数更容易学和使用。通过联合许多简单的tidyverse函数，完成一项复杂的数据处理任务变得非常容易。整个过程如同搭积木一样。

总之，相比Python，我认为R更擅长数据分析。

## 在数据可视化方面，R非常优秀

可视化是选择数据分析软件的一个重要的标准。除了擅长数据分析外，R的另外一个闪光点就是它的画图能力特别强, 这也使R与其他编程语言脱颖而出。

对于数据可视化，R中有很多优秀的包（package），比如：

* 对于静态图，比如ggplot2，ggmap，Lattice
* 对于动态图，比如gganimate，REmap，animation
* 对于交互式图， 比如plotly，rCharts

基于上述库，几乎可以绘制出所有类型的图。不信的话，你可以Google一下，输入 ‘R visualization’ 关键字。当然了，国内某知名站有可能会出现类似“R大数据学习速成课，高薪就业”之类的东西。

虽然Python也有一些不错的可视化库，如matplotlib，Seaborn，Bokeh和Pygal。但相比于R，呈现的结果并不总是那么顺眼。

此外，相较于excel\matlab等“软件”。R是编程语言，批量作图也是特别方便。

## 如果你是统计学相关，学R

如果你在做统计学方面的研究，建议你学R。事实上，因为R在统计工具开发中比其他编程语言占主导地位的主要原因。R主要被称为统计语言。

很多统计学的学生都在使用R，但是他们对程序编程知道的很少。如果你也是这种情况，我强烈建议你去学R。

貌似统计学家更喜欢使用R，比如当你看到一本统计学书籍时，你会发现他们使用的代码常常都是用R写的。很多统计学家都是R社区的贡献大牛。

基本上所有统计算法在R中都可以实现。因此，如果你想使用一些比较少见的统计学技术，你可能在R中更加容易找到它们。

在大数据、数据分析师等相关招聘广告中，经常要求求聘者精通R。当然了，一般python，sql也会被要求。事实上，一般兴趣爱好者，可能选择一个python就够了。但专门从事统计学工作的你，这些东西都得学。

此外，在机器学习方面，R语言的优势则体现在与学术界的强大联动效应。

R允许我们执行各种机器学习操作,例如分类和回归。同时，R也提供了用于开发人工神经网络的各种程序包和功能。R被世界上最好的数据科学家使用。在这一领域的任何新型研究成果可能都会马上以R软件包的形式体现出来。

目前已经有众多主流机器学习算法以R语言作为实现手段。因此从这个角度看，R语言始终站在技术发展的尖端位置。

## R也有其缺点，但依旧备受青睐

R编程语言被广泛应用在统计和科学领域，在云计算领域处于领先地位。

在Redmond最近发布的编程语言排名中，把R列为排在第13位。IEEESpectrum推出的最流行的编程语言排行榜中，R语言在数据语言中位列第三；TiobeSoftware的资料显示，今年1月份，R成为排在第18位的用户最多的编程语言，1年前它仅排在第44位。PYPL(编程语言流行指数)依据Google上关于语言教程的搜索频率进行统计。从全球搜索引擎流行度来看，R语言排名第9。

尽管R软件在上述的一些特定领域非常风靡，得到广泛采用，但它在企业领域却迟迟没有取得进展，这主要是受到了数据和处理限制相关挑战的影响。

比较明显的几个缺点有：

1. 数据处理：在R中, 对象存储在物理内存中。与其他编程语言(如Python)形成对比。与Python相比, R使用更多的内存。它需要将整个数据放在内存中的一个位置。当我们处理大数据时, 这不是理想的选择。
2. 基本安全：R缺乏基本的安全性。它是大多数编程语言(例如Python)的重要组成部分。因此, R无法嵌入到Web应用程序中, 因此存在很多限制。
3. 语言复杂：R语言，应该是一门脚本，一个工具。但当你把它作为一个编程语言来看待时，你会发现R是一种非常复杂的语言, 并且学习曲线很陡。有先验知识或编程经验的人可能会发现很难学习R。
4. 起源薄弱：起源问题带给R的主要缺点是它不支持动态或3D图形。因为它与更古老的编程语言” S”共享其起源。
5. 速度较慢：R编程语言比其他编程语言(例如MATLAB和Python)慢得多。与其他编程语言相比, R软件包要慢得多。
6. 算法难找：在R中, 算法分布在不同的程序包中。不了解软件包的程序员可能会发现难以实现算法。

但是对于熟练掌握R的人来说，可能真正的限制，还是性能和速度。由于开源R软件在内存中运行，它无法处理庞大、多样化的数据，因而限制了它能够处理的信息量。此外，由于R软件采用单线程设计，它无法并行运行，因此会显著增加处理时间。

有些企业也尝试了多种方法来消除开源R软件的内存限制。

其中一种方法是购买配备了大容量内存的大型服务器。此方法的缺点是内存非常昂贵，同时企业仍然受到服务器的数据限制的影响。此外，这一方法不可扩展。

另一种方法是在多个服务器或节点上并发运行R引擎。这一方法在包含数据的服务器上执行作业，在数据划分清晰时有着出色表现。然而，有的用例要求建立并行算法，或使用另一种能够在所有服务器和节点上运行的方法，以处理所有数据。但要实现这一目标却并非易事。

市面上也有解决方案提供商尝试了多种方法来解决这些不足，但时至今日，他们仅取得了部分成功。其中我个人有所了解的，应该是Teradata Aster R。

Teradata Aster R解决方案充分利用了R的优势，同时摒弃了传统的限制，提供了快速、强大的分析功能。过去希望使用R，但由于其传统劣势最终放弃的数据专业人员，或许可以从这款解决了那些难题的企业级解决方案中获益匪浅。

此外，R的背后还有这微软、Google两大厂的支持。

（1）微软收购R编程语言

微软负责机器学习的副总裁JosephSirosh在博客中写道，“金融、制造、健康、零售、学术研究在内的各个领域需要强有力的数据分析工具来支持他们做出数据导向的决策……R语言能够帮助雇员去填补公司数据分析上的空白”。被收购之后，RevolutionAnalytics表示将持续支持R语言的开源项目并提供给客户订阅式的技术支持服务。

（2）Google发布R语言格式规范内部指导

2016年9月，Google已发布R语言的15格式规范内部指导，这说明R语言的使用在Google内部也得到了较为广泛的认可，并有可能扩大使用规模，所以统一发布这个指导，以规范今后的代码。

R语言以其简单易学、免费开源的特性，正在各个领域发挥着越来越重要的作用。R语言的出生不是昙花一现，那么我们也有理由相信：它的辉煌的成长过程必将是前路宽阔，R语言的寒武纪时代已然来临。因为：现代数据科学需要它，社会发展需要它。

## 总结

R是一款集成了数据操作、统计和可视化功能的优秀的开源语言。R具备高效的数据处理和存储功能，擅长数据矩阵操作，提供了大量适用于数据分析的工具，支持各种数据可视化输出。

R的一大优势是分析人员可利用简单的R程序语言描述处理过程，以构建强大的分析功能。此外，R具备良好可扩展性，来自世界各地开源社区的研究者为其提供了各种丰富的工具包。由于R能结合各种挖掘算法，有效地简化数据分析过程，适用于数据挖掘领域。

此外R的也具备一些缺点。但是呢，对于个人学习的过程来说，和企业应用还是有差别的。我认为R只是工具，它可能不够先进，但它足够我们掌握统计学知识。从这个意义上说，我认为R作为一门教学与学习的语言。可以说他是没有缺点的。

所以，如果你的编程经验有限，并且你主要是做数据分析、统计学(或者学我的超智·统计学系列课程)，短期内应该不会开发什么程序软件，那我推荐先学R。